---
permalink: /:basename
title: Demos
---

<!doctype html>

<html>
	<head>
		<title>Cade Conradson - {{ page.title }}</title>
		<link rel="shortcut icon" type="image/jpg" href="{{ site.url }}/assets/images/snakeface.jpg">
		<link rel="stylesheet" type="text/css" href="{{ site.url }}/assets/css/main.css">
		<link rel="stylesheet" type="text/css" href="{{ site.url }}/assets/css/column.css">
		<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
		<script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
		<script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
		<style>
		.doubleslider-container {
			float: left;
			position: relative;
			width: 50%;
			height: 22px;
		}
		
		.dslider {
			position: absolute;
			-webkit-appearance: none;
			appearance: none;
			width: 100%;
		}
		
		.dslider::-webkit-slider-thumb {
			position: relative;
			z-index: 20;
		}
		
		.dslider::-moz-range-thumb {
			position: relative;
			z-index: 20;
		}
		
		.slidertext {
			float: left;
			width: 18px;
			margin-left: 4px;
		}
		
		.reset {
			float: left;
			margin-left: 5px;
		}
		
		.slidewrap:after {
			content: "";
			display: table;
			clear: both;
		}
		</style>
	</head>
	
	<body>
		<div id="wrap">
		
			<div id="header">
				<h3 class='site-title'>{{ site.title }}</h3>
				<p class='page-title'>{{ page.title }}</p>
			</div>
			
			<div class="nav">
				<a href="{{ site.url }}">Home</a>
				<a href="{{ site.url }}/projects/">Projects</a>
				<a href="{{ site.url }}/interests/">For Fun</a>
				<a href="{{ site.url }}/about/">About</a>
			</div>
			
			<div class = "body">
				Start: 
				<input type="text" id="start" value="1">
				End: 
				<input type="text" id="end" value="44">
				Seasons out: 
				<input type="text" id="seasons" value="all">
				Start tier:
				<input type="text" id="startTier" value="all">
				Exact: 
				<input type="checkbox" id="exact">
				<button id="Calculate">Go</button>
				<div id="widthcheck"><!-- I need this for determining render width --></div>
				<div id="visual"></div>
								
				<script type="text/javascript">
					var promotions = {{ site.data.chart_promotions | jsonify }};
					var schemesLength = promotions.schemes.length;
					var currentSeason = promotions.tiers.length;
					var seasonRange = [1, currentSeason];
					var seasonsOut = "all";
					var startTier = "all";	
					var exact = false;									
					
					findProps();
					
					document.getElementById("Calculate").onclick = function() {
						seasonRange = [Number(document.getElementById("start").value), Number(document.getElementById("end").value)];
						seasonsOut = document.getElementById("seasons").value;
						if (!(seasonsOut == "all")) {seasonsOut = Number(seasonsOut);}
						startTier = document.getElementById("startTier").value;
						exact = document.getElementById("exact").checked;
						findProps()
					};

					function findProps() {
						var allFuture = (seasonsOut == "all");
						var allTiers = (startTier == "all");
						var tiers = allFuture ? ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J"] : [...new Set(promotions.tiers.slice(seasonRange[0] - 1 + (exact ? seasonsOut : 1), seasonRange[1] + seasonsOut - 1).join(""))];
						var props = {};
						for (let j=0; j<tiers.length; j++) {
							props[tiers[j]] = {"tier": tiers[j], "count": 0};
						}
						if (exact) {
							tiers.push("-");
							props["-"] = {"tier": "Out", "count": 0};
						}
						var total = 0;
						
						var start = new RegExp("^" + (allTiers ? "[^-]" : startTier));
						var totadd = [];
						var countadd = [];
						for (let i=0; i<schemesLength; i++) {
							if (allFuture) {
								total += regExpChecker(start, promotions.schemes[i], seasonRange[0]-1, seasonRange[1]);
							} else {
								total += regExpCounter(start, promotions.schemes[i], seasonRange[0]-1, seasonRange[1]);
							}
							for (let j=0; j<tiers.length; j++) {
								if (allFuture) {
									let reg = new RegExp("^" + (allTiers ? "[^-]" : startTier) + ".*" + tiers[j] + (exact ? "$" : ""));
									if (regExpChecker(reg, promotions.schemes[i], seasonRange[0]-1, seasonRange[1])) {
										props[tiers[j]].count += 1;
									} else if (allTiers) {
										if (!exact) {
											reg = new RegExp("^" + tiers[j]);
											props[tiers[j]].count += regExpChecker(reg, promotions.schemes[i], seasonRange[0]-1, seasonRange[1]);
										} else if (seasonRange[1] == currentSeason) {
											reg = new RegExp(tiers[j] + "$");
											props[tiers[j]].count += regExpChecker(reg, promotions.schemes[i], seasonRange[0]-1, seasonRange[1]);
										}
									}	
								} else {
									let reg = new RegExp("^" + (allTiers ? "[^-]" : startTier) + ".{" + (exact ? "" : "0,") + (seasonsOut-1) + "}" + tiers[j]);
									props[tiers[j]].count += regExpCounter(reg, promotions.schemes[i], seasonRange[0]-1, seasonRange[1]);
								}
							}
						}
						props = Object.keys(props).map(key => props[key]);
						for (let i=0; i<props.length; i++) {
							props[i].prop = props[i].count/total;
						}
						document.getElementById("visual").innerHTML = JSON.stringify(props);
						
						function regExpCounter(regex, string, start, end) {
							let count = 0;
							for (let i=start; i<end; i++) {
								let k = string.slice(i);
								count += regex.test(k);
							}
							return count;
						}
						
						function regExpChecker(regex, string, start, end) {
							for (let i=start; i<end; i++) {
								if (regex.test(string.slice(i))) {
									return true;
								}
							}
							return false;
						}
					}
				</script>
			</div>
		
		</div>
	</body>
</html>